var blob = {
    "countries": [
        {
            "mcc": "269", 
            "name": "Rangiroa", 
            "prices": [
                {
                    "amount": "0.0000", 
                    "connectivities": [
                        {
                            "credit_providers": [
                                {
                                    "daily_spending_limit": 50, 
                                    "mnc": "06", 
                                    "monthly_spending_limit": 300, 
                                    "rid": "mop/PT/TMN", 
                                    "routes": [
                                        {
                                            "lane": "68999", 
                                            "type_of_billing": "MT"
                                        }, 
                                        {
                                            "lane": "68985", 
                                            "type_of_billing": "MT"
                                        }
                                    ]
                                }, 
                                {
                                    "daily_spending_limit": 50, 
                                    "mnc": "01", 
                                    "monthly_spending_limit": 300, 
                                    "rid": "mop/PT/Vodafone", 
                                    "routes": [
                                        {
                                            "lane": "68999", 
                                            "type_of_billing": "MT"
                                        }, 
                                        {
                                            "lane": "68985", 
                                            "type_of_billing": "MT"
                                        }
                                    ]
                                }, 
                                {
                                    "daily_spending_limit": 50, 
                                    "mnc": "03", 
                                    "monthly_spending_limit": 300, 
                                    "rid": "mop/PT/Optimus", 
                                    "routes": [
                                        {
                                            "lane": "68999", 
                                            "type_of_billing": "MT"
                                        }, 
                                        {
                                            "lane": "68985", 
                                            "type_of_billing": "MT"
                                        }
                                    ]
                                }
                            ], 
                            "rid": "Mobileviewpt"
                        }, 
                        {
                            "credit_providers": [
                                {
                                    "daily_spending_limit": 50, 
                                    "mnc": "06", 
                                    "monthly_spending_limit": 300, 
                                    "rid": "mop/PT/TMN", 
                                    "routes": [
                                        {
                                            "lane": "68636", 
                                            "type_of_billing": "MT"
                                        }, 
                                        {
                                            "lane": "68638", 
                                            "type_of_billing": "MT"
                                        }, 
                                        {
                                            "lane": "68637", 
                                            "type_of_billing": "MT"
                                        }
                                    ]
                                }, 
                                {
                                    "daily_spending_limit": 50, 
                                    "mnc": "01", 
                                    "monthly_spending_limit": 300, 
                                    "rid": "mop/PT/Vodafone", 
                                    "routes": [
                                        {
                                            "lane": "68636", 
                                            "type_of_billing": "MT"
                                        }, 
                                        {
                                            "lane": "68638", 
                                            "type_of_billing": "MT"
                                        }, 
                                        {
                                            "lane": "68637", 
                                            "type_of_billing": "MT"
                                        }
                                    ]
                                }, 
                                {
                                    "daily_spending_limit": 50, 
                                    "mnc": "03", 
                                    "monthly_spending_limit": 300, 
                                    "rid": "mop/PT/Optimus", 
                                    "routes": [
                                        {
                                            "lane": "68636", 
                                            "type_of_billing": "MT"
                                        }, 
                                        {
                                            "lane": "68638", 
                                            "type_of_billing": "MT"
                                        }, 
                                        {
                                            "lane": "68637", 
                                            "type_of_billing": "MT"
                                        }
                                    ]
                                }
                            ], 
                            "rid": "Mobiletrendpt"
                        }
                    ], 
                    "currency": "EUR", 
                    "type": "point"
                }, 
                {
                    "amount": "2.1000", 
                    "connectivities": [
                        {
                            "credit_providers": [
                                {
                                    "daily_spending_limit": 50, 
                                    "mnc": "06", 
                                    "monthly_spending_limit": 300, 
                                    "rid": "mop/PT/TMN", 
                                    "routes": [
                                        {
                                            "lane": "68636", 
                                            "type_of_billing": "MO"
                                        }
                                    ]
                                }, 
                                {
                                    "daily_spending_limit": 50, 
                                    "mnc": "01", 
                                    "monthly_spending_limit": 300, 
                                    "rid": "mop/PT/Vodafone", 
                                    "routes": [
                                        {
                                            "lane": "68636", 
                                            "type_of_billing": "MO"
                                        }
                                    ]
                                }, 
                                {
                                    "daily_spending_limit": 50, 
                                    "mnc": "03", 
                                    "monthly_spending_limit": 300, 
                                    "rid": "mop/PT/Optimus", 
                                    "routes": [
                                        {
                                            "lane": "68636", 
                                            "type_of_billing": "MO"
                                        }
                                    ]
                                }
                            ], 
                            "rid": "Mobiletrendpt"
                        }
                    ], 
                    "currency": "EUR", 
                    "type": "point"
                }
            ]
        },
        {
            "mcc": "268", 
            "name": "Portugal", 
            "prices": [
                {
                    "amount": "0.0000", 
                    "connectivities": [
                        {
                            "credit_providers": [
                                {
                                    "daily_spending_limit": 50, 
                                    "mnc": "06", 
                                    "monthly_spending_limit": 300, 
                                    "rid": "mop/PT/TMN", 
                                    "routes": [
                                        {
                                            "lane": "68999", 
                                            "type_of_billing": "MT"
                                        }, 
                                        {
                                            "lane": "68985", 
                                            "type_of_billing": "MT"
                                        }
                                    ]
                                }, 
                                {
                                    "daily_spending_limit": 50, 
                                    "mnc": "01", 
                                    "monthly_spending_limit": 300, 
                                    "rid": "mop/PT/Vodafone", 
                                    "routes": [
                                        {
                                            "lane": "68999", 
                                            "type_of_billing": "MT"
                                        }, 
                                        {
                                            "lane": "68985", 
                                            "type_of_billing": "MT"
                                        }
                                    ]
                                }, 
                                {
                                    "daily_spending_limit": 50, 
                                    "mnc": "03", 
                                    "monthly_spending_limit": 300, 
                                    "rid": "mop/PT/Optimus", 
                                    "routes": [
                                        {
                                            "lane": "68999", 
                                            "type_of_billing": "MT"
                                        }, 
                                        {
                                            "lane": "68985", 
                                            "type_of_billing": "MT"
                                        }
                                    ]
                                }
                            ], 
                            "rid": "Mobileviewpt"
                        }, 
                        {
                            "credit_providers": [
                                {
                                    "daily_spending_limit": 50, 
                                    "mnc": "06", 
                                    "monthly_spending_limit": 300, 
                                    "rid": "mop/PT/TMN", 
                                    "routes": [
                                        {
                                            "lane": "68636", 
                                            "type_of_billing": "MT"
                                        }, 
                                        {
                                            "lane": "68638", 
                                            "type_of_billing": "MT"
                                        }, 
                                        {
                                            "lane": "68637", 
                                            "type_of_billing": "MT"
                                        }
                                    ]
                                }, 
                                {
                                    "daily_spending_limit": 50, 
                                    "mnc": "01", 
                                    "monthly_spending_limit": 300, 
                                    "rid": "mop/PT/Vodafone", 
                                    "routes": [
                                        {
                                            "lane": "68636", 
                                            "type_of_billing": "MT"
                                        }, 
                                        {
                                            "lane": "68638", 
                                            "type_of_billing": "MT"
                                        }, 
                                        {
                                            "lane": "68637", 
                                            "type_of_billing": "MT"
                                        }
                                    ]
                                }, 
                                {
                                    "daily_spending_limit": 50, 
                                    "mnc": "03", 
                                    "monthly_spending_limit": 300, 
                                    "rid": "mop/PT/Optimus", 
                                    "routes": [
                                        {
                                            "lane": "68636", 
                                            "type_of_billing": "MT"
                                        }, 
                                        {
                                            "lane": "68638", 
                                            "type_of_billing": "MT"
                                        }, 
                                        {
                                            "lane": "68637", 
                                            "type_of_billing": "MT"
                                        }
                                    ]
                                }
                            ], 
                            "rid": "Mobiletrendpt"
                        }
                    ], 
                    "currency": "EUR", 
                    "type": "point"
                }, 
                {
                    "amount": "2.1000", 
                    "connectivities": [
                        {
                            "credit_providers": [
                                {
                                    "daily_spending_limit": 50, 
                                    "mnc": "06", 
                                    "monthly_spending_limit": 300, 
                                    "rid": "mop/PT/TMN", 
                                    "routes": [
                                        {
                                            "lane": "68636", 
                                            "type_of_billing": "MO"
                                        }
                                    ]
                                }, 
                                {
                                    "daily_spending_limit": 50, 
                                    "mnc": "01", 
                                    "monthly_spending_limit": 300, 
                                    "rid": "mop/PT/Vodafone", 
                                    "routes": [
                                        {
                                            "lane": "68636", 
                                            "type_of_billing": "MO"
                                        }
                                    ]
                                }, 
                                {
                                    "daily_spending_limit": 50, 
                                    "mnc": "03", 
                                    "monthly_spending_limit": 300, 
                                    "rid": "mop/PT/Optimus", 
                                    "routes": [
                                        {
                                            "lane": "68636", 
                                            "type_of_billing": "MO"
                                        }
                                    ]
                                }
                            ], 
                            "rid": "Mobiletrendpt"
                        }
                    ], 
                    "currency": "EUR", 
                    "type": "point"
                }, 
                {
                    "amount": "2.4600", 
                    "connectivities": [
                        {
                            "credit_providers": [
                                {
                                    "daily_spending_limit": 50, 
                                    "mnc": "06", 
                                    "monthly_spending_limit": 300, 
                                    "rid": "mop/PT/TMN", 
                                    "routes": [
                                        {
                                            "lane": "68999", 
                                            "type_of_billing": "MO"
                                        }
                                    ]
                                }, 
                                {
                                    "daily_spending_limit": 50, 
                                    "mnc": "01", 
                                    "monthly_spending_limit": 300, 
                                    "rid": "mop/PT/Vodafone", 
                                    "routes": [
                                        {
                                            "lane": "68999", 
                                            "type_of_billing": "MO"
                                        }
                                    ]
                                }, 
                                {
                                    "daily_spending_limit": 50, 
                                    "mnc": "03", 
                                    "monthly_spending_limit": 300, 
                                    "rid": "mop/PT/Optimus", 
                                    "routes": [
                                        {
                                            "lane": "68999", 
                                            "type_of_billing": "MO"
                                        }
                                    ]
                                }
                            ], 
                            "rid": "Mobileviewpt"
                        }
                    ], 
                    "currency": "EUR", 
                    "type": "point"
                }, 
                {
                    "amount": "3.0000", 
                    "connectivities": [
                        {
                            "credit_providers": [
                                {
                                    "daily_spending_limit": 50, 
                                    "mnc": "06", 
                                    "monthly_spending_limit": 300, 
                                    "rid": "mop/PT/TMN", 
                                    "routes": [
                                        {
                                            "lane": "68637", 
                                            "type_of_billing": "MO"
                                        }
                                    ]
                                }, 
                                {
                                    "daily_spending_limit": 50, 
                                    "mnc": "01", 
                                    "monthly_spending_limit": 300, 
                                    "rid": "mop/PT/Vodafone", 
                                    "routes": [
                                        {
                                            "lane": "68637", 
                                            "type_of_billing": "MO"
                                        }
                                    ]
                                }, 
                                {
                                    "daily_spending_limit": 50, 
                                    "mnc": "03", 
                                    "monthly_spending_limit": 300, 
                                    "rid": "mop/PT/Optimus", 
                                    "routes": [
                                        {
                                            "lane": "68637", 
                                            "type_of_billing": "MO"
                                        }
                                    ]
                                }
                            ], 
                            "rid": "Mobiletrendpt"
                        }
                    ], 
                    "currency": "EUR", 
                    "type": "point"
                }, 
                {
                    "amount": "4.0000", 
                    "connectivities": [
                        {
                            "credit_providers": [
                                {
                                    "daily_spending_limit": 50, 
                                    "mnc": "06", 
                                    "monthly_spending_limit": 300, 
                                    "rid": "mop/PT/TMN", 
                                    "routes": [
                                        {
                                            "lane": "68638", 
                                            "type_of_billing": "MO"
                                        }
                                    ]
                                }, 
                                {
                                    "daily_spending_limit": 50, 
                                    "mnc": "01", 
                                    "monthly_spending_limit": 300, 
                                    "rid": "mop/PT/Vodafone", 
                                    "routes": [
                                        {
                                            "lane": "68638", 
                                            "type_of_billing": "MO"
                                        }
                                    ]
                                }, 
                                {
                                    "daily_spending_limit": 50, 
                                    "mnc": "03", 
                                    "monthly_spending_limit": 300, 
                                    "rid": "mop/PT/Optimus", 
                                    "routes": [
                                        {
                                            "lane": "68638", 
                                            "type_of_billing": "MO"
                                        }
                                    ]
                                }
                            ], 
                            "rid": "Mobiletrendpt"
                        }
                    ], 
                    "currency": "EUR", 
                    "type": "point"
                }, 
                {
                    "amount": "6.1500", 
                    "connectivities": [
                        {
                            "credit_providers": [
                                {
                                    "daily_spending_limit": 50, 
                                    "mnc": "06", 
                                    "monthly_spending_limit": 300, 
                                    "rid": "mop/PT/TMN", 
                                    "routes": [
                                        {
                                            "lane": "68985", 
                                            "type_of_billing": "MO"
                                        }
                                    ]
                                }, 
                                {
                                    "daily_spending_limit": 50, 
                                    "mnc": "01", 
                                    "monthly_spending_limit": 300, 
                                    "rid": "mop/PT/Vodafone", 
                                    "routes": [
                                        {
                                            "lane": "68985", 
                                            "type_of_billing": "MO"
                                        }
                                    ]
                                }, 
                                {
                                    "daily_spending_limit": 50, 
                                    "mnc": "03", 
                                    "monthly_spending_limit": 300, 
                                    "rid": "mop/PT/Optimus", 
                                    "routes": [
                                        {
                                            "lane": "68985", 
                                            "type_of_billing": "MO"
                                        }
                                    ]
                                }
                            ], 
                            "rid": "Mobileviewpt"
                        }
                    ], 
                    "currency": "EUR", 
                    "type": "point"
                }
            ], 
            "rid": "PT"
        }
    ]
}

var navigationApp = angular.module('navigationSandbox', []);

navigationApp.controller('template3Controller', function($scope){
    $scope.currentCountry = null; // to be chosen in the first select
    $scope.currentPrice = null; // to be chosen in the second select
    $scope.currentConnectivity = null; // to be chosen in the third select
    $scope.countries = blob.countries;
  })
  .directive('countryData',function($templateCache){
    return {
      restrict: 'E',
      template: $templateCache.get('country.tmpl'),
      transclude: true,
      link: function(scope,element,attrs){
        scope.$watch(attrs.name,function(value){
          if (!value) return;
          repaint();
        });
        function repaint(){
          element.html(template);
          $compile(element.contents())(scope);
        }
      }
    }
  })
  .directive('priceData',function($templateCache){
    return {
      restrict: 'E',
      template: $templateCache.get('price.tmpl'),
      transclude: true,
      link: function(scope,element,attrs){
        scope.$watch(attrs.amount,function(value){
          if (!value) return;
          repaint();
        });
        function repaint(){
          element.html(template);
          $compile(element.contents())(scope);
        }
      }
    }
  })

